var e=(e,t,n)=>new Promise(((o,a)=>{var s=e=>{try{c(n.next(e))}catch(t){a(t)}},r=e=>{try{c(n.throw(e))}catch(t){a(t)}},c=e=>e.done?o(e.value):Promise.resolve(e.value).then(s,r);c((n=n.apply(e,t)).next())}));import{_ as t}from"./PageWrapper.50cc8deb.js";import{aP as n,ag as o,d as a,af as s,r,ao as c,j as l,aQ as i,ba as u,b8 as p,bd as d,i as f,ah as m,W as b,X as g,be as v,N as h,L as y,O as P,aj as O,bI as R,bJ as E,bK as w,bL as j,aa as C,c as x,g as T,a as S,b as L,h as A,t as B,aG as D}from"./vendor.9dfb8857.js";import{H as M,b as N,W as k,am as V,o as W,ay as _,r as G,a9 as U}from"./index.19d428bb.js";import{a as H,u as I}from"./useTabs.f2da27ed.js";import"./index.9c2a56c0.js";function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Q(){}function X(e,t,n){var o,a;return null!==(a=null===(o=e[n])||void 0===o?void 0:o.call(e))&&void 0!==a?a:t[n]}var q,z,Y={success:h,info:y,error:P,warning:O},Z={success:R,info:E,error:w,warning:j},$=o("success","info","warning","error"),ee=n(a({name:"AAlert",inheritAttrs:!1,props:{type:s.oneOf($),closable:s.looseBool,closeText:s.VNodeChild,message:s.VNodeChild,description:s.VNodeChild,afterClose:s.func.def(Q),showIcon:s.looseBool,prefixCls:s.string,banner:s.looseBool,icon:s.VNodeChild,onClose:s.VNodeChild},emits:["close"],setup:function(e,t){var n=t.slots,o=t.emit,a=t.attrs,s=t.expose,h=f("configProvider",m),y=r(!1),P=r(!1),O=r(),R=function(e){e.preventDefault();var t=O.value;t.style.height="".concat(t.offsetHeight,"px"),t.style.height="".concat(t.offsetHeight,"px"),y.value=!0,o("close",e)},E=function(){var t;y.value=!1,P.value=!0,null===(t=e.afterClose)||void 0===t||t.call(e)};return s({animationEnd:E}),function(){var t,o=e.prefixCls,s=e.banner,r=(0,h.getPrefixCls)("alert",o),f=e.closable,m=e.type,w=e.showIcon,j=X(n,e,"closeText"),C=X(n,e,"description"),x=X(n,e,"message"),T=X(n,e,"icon");w=!(!s||void 0!==w)||w;var S=(C?Z:Y)[m=s&&void 0===m?"warning":m||"info"]||null;j&&(f=!0);var L=c(r,(J(t={},"".concat(r,"-").concat(m),!0),J(t,"".concat(r,"-closing"),y.value),J(t,"".concat(r,"-with-description"),!!C),J(t,"".concat(r,"-no-icon"),!w),J(t,"".concat(r,"-banner"),!!s),J(t,"".concat(r,"-closable"),f),t)),A=f?l("button",{type:"button",onClick:R,class:"".concat(r,"-close-icon"),tabindex:0},[j?l("span",{class:"".concat(r,"-close-text")},[j]):l(i,null,null)]):null,B=T&&(u(T)?p(T,{class:"".concat(r,"-icon")}):l("span",{class:"".concat(r,"-icon")},[T]))||l(S,{class:"".concat(r,"-icon")},null),D=d("".concat(r,"-slide-up"),{appear:!1,onAfterLeave:E});return P.value?null:l(v,D,{default:function(){return[b(l("div",F(F({},a),{},{class:[a.class,L],"data-show":!y.value,ref:O}),[w?B:null,l("div",{class:"".concat(r,"-content")},[l("div",{class:"".concat(r,"-message")},[x]),l("div",{class:"".concat(r,"-description")},[C])]),A]),[[g,!y.value]])]}})}}}));(z=q||(q={})).SUPER="super",z.TEST="test";var te=a({name:"PermissionFrontDemo",components:{ButtonGroup:C.Group,Button:C,PageWrapper:t,Alert:ee},setup(){const{changeRole:t}=function(){const t=M(),n=N(),o=k(),{closeAll:a}=H(G);function s(t){return e(this,null,(function*(){I().clearCacheTabs(),_(),(yield o.buildRoutesAction(t)).forEach((e=>{G.addRoute(e)})),o.setLastBuildMenuTime(),yield a()}))}return{togglePermissionMode:function(){return e(this,null,(function*(){n.setProjectConfig({permissionMode:V.permissionMode===W.BACK?W.ROLE:W.BACK}),location.reload()}))},changeRole:function(n){return e(this,null,(function*(){if(V.permissionMode!==W.ROLE)throw new Error("please switch permissionModeEnum to ROLE mode in the configuration to operate");U(n)||(n=[n]),t.setRoleList(n),yield s()}))},resume:s}}(),n=M(),o=x((()=>n.getRoleList.includes(q.SUPER))),a=x((()=>n.getRoleList.includes(q.TEST)));return{userStore:n,RoleEnum:q,isSupper:o,isTest:a,changeRole:t}}});const ne=l("span",null,"当前角色",-1),oe={class:"mt-4"},ae=l("span",null,"权限切换(请先切换权限模式为前端角色权限模式): ",-1);te.render=function(e,t,n,o,a,s){const r=T("Alert"),c=T("Button"),i=T("ButtonGroup"),u=T("PageWrapper");return S(),L(u,{title:"前端权限示例","content-background":"","content-class":"p-4",content:"由于刷新的时候会请求用户信息接口，会根据接口重置角色信息，所以刷新后界面会恢复原样，如果不需要，可以注释 src/layout/default/index内的获取用户信息接口"},{default:A((()=>[l("p",null,[ne,l("a",null,B(e.userStore.getRoleList),1)]),l(r,{"show-icon":"",class:"mt-4",type:"info",message:"点击后请查看左侧菜单变化"}),l("div",oe,[ae,l(i,null,{default:A((()=>[l(c,{type:e.isSupper?"primary":"default",onClick:t[1]||(t[1]=t=>e.changeRole(e.RoleEnum.SUPER))},{default:A((()=>[D(B(e.RoleEnum.SUPER),1)])),_:1},8,["type"]),l(c,{type:e.isTest?"primary":"default",onClick:t[2]||(t[2]=t=>e.changeRole(e.RoleEnum.TEST))},{default:A((()=>[D(B(e.RoleEnum.TEST),1)])),_:1},8,["type"])])),_:1})])])),_:1})};export default te;
